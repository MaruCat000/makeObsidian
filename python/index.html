<!DOCTYPE html>
// グラフ表示用HTML (index.html)
<html>
<head>
    <meta charset="utf-8">
    <title>Graph View</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        svg { width: 100vw; height: 100vh; background: #f0f0f0; }
        .node { fill: #69b3a2; stroke: #fff; }
        .link { stroke: #999; stroke-opacity: 0.6; }
    </style>
</head>
<body>
    <div id="graph"></div>
    <script>
        // パスの指定しなおし
        // 「同じフォルダ内にある data.json」を読み込むように指定
        d3.json("./data.json").then(data => {
            const width = window.innerWidth, height = window.innerHeight;
            const svg = d3.select("#graph").append("svg").attr("viewBox", [0, 0, width, height]);

            const simulation = d3.forceSimulation(data.nodes)
                .force("link", d3.forceLink(data.links).id(d => d.id).distance(100))
                .force("charge", d3.forceManyBody().strength(-200))
                .force("center", d3.forceCenter(width / 2, height / 2));

            const link = svg.append("g").selectAll("line").data(data.links).join("line").attr("class", "link");
            const node = svg.append("g").selectAll("circle").data(data.nodes).join("circle").attr("class", "node").attr("r", 10);
            const label = svg.append("g").selectAll("text").data(data.nodes).join("text").text(d => d.id).attr("dx", 12).attr("dy", 4);

            simulation.on("tick", () => {
                link.attr("x1", d => d.source.x).attr("y1", d => d.source.y).attr("x2", d => d.target.x).attr("y2", d => d.target.y);
                node.attr("cx", d => d.x).attr("cy", d => d.y);
                label.attr("x", d => d.x).attr("y", d => d.y);
            });
        });
    </script>
</body>
</html>